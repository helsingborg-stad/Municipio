{"version":3,"file":"mod-curator-load-more.C9nRraDR.js","sources":["../../../source/php/Module/Curator/assets/mod-curator-load-more.js"],"sourcesContent":["function loadMoreHandler(event) {\n\tevent.preventDefault();\n\n\tconst parent = event.target.closest(\".mod-curator-load-more\");\n\n\tconst embedCode = parent.getAttribute(\"data-code\");\n\tconst itemCount = parseInt(parent.getAttribute(\"data-item-count\"));\n\tconst itemsPerPage = parseInt(parent.getAttribute(\"data-items-per-page\"));\n\tlet itemsLoaded = parseInt(parent.getAttribute(\"data-items-loaded\"));\n\n\tconst grandParent = parent.closest(\".modularity-socialmedia-container\");\n\tconst socialMediaBlocks = grandParent.querySelector(\n\t\t\".modularity-socialmedia__content\",\n\t);\n\tconst placeholderBlocks = socialMediaBlocks.querySelectorAll(\n\t\t\".modularity-socialmedia__item--placeholder\",\n\t);\n\n\tplaceholderBlocks.forEach((block) => {\n\t\tblock.classList.remove(\"u-display--none\");\n\t});\n\tif (itemsLoaded < itemCount) {\n\t\tgetFeed(embedCode, itemsPerPage, itemsLoaded)\n\t\t\t.then((response) => {\n\t\t\t\tif (response.success && response.posts) {\n\t\t\t\t\tupdateItems(response.posts, parent);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t} else {\n\t\tplaceholderBlocks.forEach((block) => {\n\t\t\tblock.remove();\n\t\t});\n\t\tparent.innerHTML = curator.noMoreItems;\n\t}\n}\n\nfunction getFeed(embedCode, limit, offset) {\n\tconst url = curator.ajaxurl;\n\tconst data = new FormData();\n\n\tdata.append(\"action\", \"mod_curator_get_feed\");\n\tdata.append(\"nonce\", curator.nonce);\n\tdata.append(\"embed-code\", embedCode);\n\tdata.append(\"limit\", limit);\n\tdata.append(\"offset\", offset);\n\n\treturn fetch(url, {\n\t\tmethod: \"POST\",\n\t\tbody: data,\n\t}).then((response) => {\n\t\tif (response.ok) {\n\t\t\treturn response.json();\n\t\t} else {\n\t\t\tthrow new Error(\"Network response was not ok\");\n\t\t}\n\t});\n}\n\nfunction updateItems(posts, button) {\n\trenderPosts(posts, button);\n\n\tconst itemsLoaded = parseInt(button.getAttribute(\"data-items-loaded\"));\n\tconst newItemsLoaded = itemsLoaded + posts.length;\n\tbutton.setAttribute(\"data-items-loaded\", newItemsLoaded);\n}\n\nfunction renderPosts(posts, button) {\n\tconst url = curator.ajaxurl;\n\tconst data = new FormData();\n\n\tdata.append(\"action\", \"mod_curator_load_more\");\n\tdata.append(\"nonce\", curator.nonce);\n\tdata.append(\"layout\", button.getAttribute(\"data-layout\"));\n\tdata.append(\"posts\", JSON.stringify(posts));\n\n\tconst closestParent = button.closest(\".modularity-socialmedia-container\");\n\tconst socialMediaBlocks = closestParent.querySelector(\n\t\t\".modularity-socialmedia__content\",\n\t);\n\tconst placeholderBlock = socialMediaBlocks.querySelector(\n\t\t\".modularity-socialmedia__item--placeholder\",\n\t);\n\tconst placeholderBlocks = socialMediaBlocks.querySelectorAll(\n\t\t\".modularity-socialmedia__item--placeholder\",\n\t);\n\tconst columnClasses = socialMediaBlocks\n\t\t.querySelector(\".modularity-socialmedia__item\")\n\t\t.getAttribute(\"class\");\n\tdata.append(\"columnClasses\", columnClasses);\n\n\tfetch(url, {\n\t\tmethod: \"POST\",\n\t\tbody: data,\n\t})\n\t\t.then((response) => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response.text();\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Network response was not ok\");\n\t\t\t}\n\t\t})\n\t\t.then((html) => {\n\t\t\tplaceholderBlock.insertAdjacentHTML(\"beforebegin\", html);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error(error);\n\t\t})\n\t\t.finally(() => {\n\t\t\tplaceholderBlocks.forEach((block) => {\n\t\t\t\tblock.classList.add(\"u-display--none\");\n\t\t\t});\n\t\t});\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\t// Select all elements with class 'mod-curator-load-more' and convert the result to an array\n\tconst loadMoreButtons = Array.from(\n\t\tdocument.getElementsByClassName(\"mod-curator-load-more\"),\n\t);\n\n\t// Add the event listener to each button in the array\n\tloadMoreButtons.forEach((button) =>\n\t\tbutton.addEventListener(\"click\", loadMoreHandler),\n\t);\n});\n"],"names":[],"mappings":"gHAAA,SAAS,gBAAgB,MAAO,CAC/B,MAAM,eAAc,EAEpB,MAAM,OAAS,MAAM,OAAO,QAAQ,wBAAwB,EAEtD,UAAY,OAAO,aAAa,WAAW,EAC3C,UAAY,SAAS,OAAO,aAAa,iBAAiB,CAAC,EAC3D,aAAe,SAAS,OAAO,aAAa,qBAAqB,CAAC,EACxE,IAAI,YAAc,SAAS,OAAO,aAAa,mBAAmB,CAAC,EAMnE,MAAM,kBAJc,OAAO,QAAQ,mCAAmC,EAChC,cACrC,kCACF,EAC6C,iBAC3C,4CACF,EAEC,kBAAkB,QAAS,OAAU,CACpC,MAAM,UAAU,OAAO,iBAAiB,CACzC,CAAC,EACG,YAAc,UACjB,QAAQ,UAAW,aAAc,WAAW,EAC1C,KAAM,UAAa,CACf,SAAS,SAAW,SAAS,OAChC,YAAY,SAAS,MAAO,MAAM,CAEpC,CAAC,EACA,MAAO,OAAU,CACjB,QAAQ,MAAM,KAAK,CACpB,CAAC,GAEF,kBAAkB,QAAS,OAAU,CACpC,MAAM,OAAM,CACb,CAAC,EACD,OAAO,UAAY,QAAQ,YAE7B,CArCS,0CAuCT,SAAS,QAAQ,UAAW,MAAO,OAAQ,CAC1C,MAAM,IAAM,QAAQ,QACd,KAAO,IAAI,SAEjB,YAAK,OAAO,SAAU,sBAAsB,EAC5C,KAAK,OAAO,QAAS,QAAQ,KAAK,EAClC,KAAK,OAAO,aAAc,SAAS,EACnC,KAAK,OAAO,QAAS,KAAK,EAC1B,KAAK,OAAO,SAAU,MAAM,EAErB,MAAM,IAAK,CACjB,OAAQ,OACR,KAAM,IACR,CAAE,EAAE,KAAM,UAAa,CACrB,GAAI,SAAS,GACZ,OAAO,SAAS,KAAI,EAEpB,MAAM,IAAI,MAAM,6BAA6B,CAE/C,CAAC,CACF,CApBS,0BAsBT,SAAS,YAAY,MAAO,OAAQ,CACnC,YAAY,MAAO,MAAM,EAGzB,MAAM,eADc,SAAS,OAAO,aAAa,mBAAmB,CAAC,EAChC,MAAM,OAC3C,OAAO,aAAa,oBAAqB,cAAc,CACxD,CANS,kCAQT,SAAS,YAAY,MAAO,OAAQ,CACnC,MAAM,IAAM,QAAQ,QACd,KAAO,IAAI,SAEjB,KAAK,OAAO,SAAU,uBAAuB,EAC7C,KAAK,OAAO,QAAS,QAAQ,KAAK,EAClC,KAAK,OAAO,SAAU,OAAO,aAAa,aAAa,CAAC,EACxD,KAAK,OAAO,QAAS,KAAK,UAAU,KAAK,CAAC,EAG1C,MAAM,kBADgB,OAAO,QAAQ,mCAAmC,EAChC,cACvC,kCACF,EACO,iBAAmB,kBAAkB,cAC1C,4CACF,EACO,kBAAoB,kBAAkB,iBAC3C,4CACF,EACO,cAAgB,kBACpB,cAAc,+BAA+B,EAC7C,aAAa,OAAO,EACtB,KAAK,OAAO,gBAAiB,aAAa,EAE1C,MAAM,IAAK,CACV,OAAQ,OACR,KAAM,IACR,CAAE,EACC,KAAM,UAAa,CACnB,GAAI,SAAS,GACZ,OAAO,SAAS,KAAI,EAEpB,MAAM,IAAI,MAAM,6BAA6B,CAE/C,CAAC,EACA,KAAM,MAAS,CACf,iBAAiB,mBAAmB,cAAe,IAAI,CACxD,CAAC,EACA,MAAO,OAAU,CACjB,QAAQ,MAAM,KAAK,CACpB,CAAC,EACA,QAAQ,IAAM,CACd,kBAAkB,QAAS,OAAU,CACpC,MAAM,UAAU,IAAI,iBAAiB,CACtC,CAAC,CACF,CAAC,CACH,CA9CS,kCAgDT,SAAS,iBAAiB,mBAAoB,IAAM,CAE3B,MAAM,KAC7B,SAAS,uBAAuB,uBAAuB,CACzD,EAGiB,QAAS,QACxB,OAAO,iBAAiB,QAAS,eAAe,CAClD,CACA,CAAC"}